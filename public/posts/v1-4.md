Today we are releasing Deno 1.4.0. It is the largest feature release yet, with
great additions like the web standard `WebSocket API`, `deno run --watch`, and
integrated test coverage.

If you already have Deno installed you can upgrade to 1.4 by running
`deno upgrade`. If you are installing Deno for the first time, you can use one
of the methods listed below:

```shell
# Using Shell (macOS and Linux):
curl -fsSL https://deno.land/x/install/install.sh | sh

# Using PowerShell (Windows):
iwr https://deno.land/x/install/install.ps1 -useb | iex

# Using Homebrew (macOS):
brew install deno

# Using Scoop (Windows):
scoop install deno

# Using Chocolatey (Windows):
choco install deno
```

You can find more installation methods at
https://deno.land/manual/getting_started/installation.

# What's New in Deno?

## Stricter type checks in `--unstable`

For all users using `--unstable` the `isolatedModules` and
`importsNotUsedAsValues` TypeScript compiler option will be enabled by default
starting with this release. This enables some stricter checks in the TypeScript
compiler that will likely lead to some new errors you have not seen before:

```
ERROR TS1205: Re-exporting a type when the '--isolatedModules' flag is provided requires using 'export type'.

ERROR TS1371: This import is never used as a value and must use 'import type' because the 'importsNotUsedAsValues' is set to 'error'.
```

These errors occur when types are imported or re-exported using
`import { MyType } from "./types.ts"` or `export { MyType } from "./types.ts"`
instead of `import type` or `export type`. To fix this error, change your type
imports and re-exports to use `export type { MyType } from "./types.ts"` and
`export type { MyType } from "./types.ts"`. Example:

```ts
// Bad
import { MyType } from "./file.ts";
export { MyType } from "./file.ts";

// Good
import type { MyType } from "./types.ts";
export type { MyType } from "./types.ts";
```

These flags also disallow the use of `const enum`.

## WebSocket API

This release adds support for the web standard
[`WebSocket API`](https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API),
available in all modern browsers. It can be used to communicate with remote
servers over the WebSocket protocol.

Here is a short example of how it works:

```js
// Start the connection to the WebSocket server at echo.websocket.org
const ws = new WebSocket("ws://echo.websocket.org/");

// Register event listeners for the open, close, and message events
ws.onopen = () => {
  console.log("WebSocket ready!");

  // Send a message over the WebSocket to the server
  ws.send("Hello World!");
};
ws.onmessage = (message) => {
  // Log the message we recieve:
  console.log("Received data:", message.data);

  // Close the websocket after receiving the message
  ws.close();
};
ws.onclose = () => console.log("WebSocket closed!");
ws.onerror = (err) => console.log("WebSocket error:", err.error);

// When running this the following is logged to the console:
//
// WebSocket ready!
// Received data: Hello World!
// WebSocket closed!
```

You can try it out locally:
`deno run --allow-net echo.websocket.org https://deno.land/posts/v1-4/websocket.js`

This release also removes the websocket connect methods from `std/ws`. Use the
`WebSocket API` instead.

## deno run --watch

Deno now has an integrated file watcher that can be used to restart a script
when any of its dependencies change.

To use it run your script like you usually would, but add the --watch flag. You
additionally have to add the `--unstable` flag, because this feature is not
stable yet.

```shell
$ echo "console.log('Hello World!')" > ./mod.ts
$ deno run --watch ./mod.ts
Check file:///home/deno/mod.ts
Hello World
Watcher Process terminated! Restarting on file change...
# now run `echo "console.log('File watching works!')" > ./mod.ts` in a different terminal
Watcher File change detected! Restarting!
Check file:///home/deno/mod.ts
File watching works!
Watcher Process terminated! Restarting on file change...
```

The watch flag takes no arguments for directories or files to watch. Instead it
automatically determines all of the local imports of your script, and watches
those.

Currently file watching is only supported for `deno run`, but in the future it
will also be added to `deno test`, `deno lint`, and other subcommands.

## deno test --cover

## deno info improvements

## CSS styling in console.log

## Updates to `deno lint`

## Updates to `deno doc`

## Updates to `deno_core`

- feat(info): Dependency count and sizes (#6786)

- feat(console): support CSS styling with "%c" (#7357)

- doc updgades

- lint upgrades

# deno_core

- refactor(core): rename CoreIsolate to JsRuntime (#7373)
- refactor(core): merge CoreIsolate and EsIsolate (#7370)

# deno_std

- BREAKING(std/fs): remove writeJson and writeJsonSync (#7256)
- BREAKING(std/fs): remove readJson and readJsonSync (#7255)

# vscode changes
